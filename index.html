<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>The Wedding of Nasrul & Naya</title>
  <meta name="description" content="Undangan Pernikahan Nasrul & Naya - 7 Februari 2026" />
  <style>
    :root{
      --bg:#f7f1e6;
      --paper:#fffaf0;
      --ink:#2b2b2b;
      --muted:#6b6b6b;
      --gold:#b79a6a;
      --gold2:#8a6e45;
      --shadow: 0 14px 34px rgba(0,0,0,.12);
      --radius: 22px;
      --ring: rgba(183,154,106,.28);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      color:var(--ink);
      background:
        radial-gradient(1200px 600px at 50% -50%, rgba(183,154,106,.25), transparent 60%),
        linear-gradient(#fff, var(--bg));
      font-family: ui-serif, Georgia, "Times New Roman", serif;
    }
    a{color:inherit}
    .wrap{max-width:560px;margin:0 auto;padding:16px 14px 110px}
    .card{
      background:rgba(255,250,240,.92);
      border:1px solid var(--ring);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .hero{
      padding:28px 18px 20px;
      text-align:center;
      position:relative;
      background:
        radial-gradient(650px 340px at 50% 0%, rgba(183,154,106,.22), transparent 60%),
        linear-gradient(180deg, rgba(183,154,106,.08), transparent 45%);
    }
    .leaf{
      position:absolute;inset:-12px -12px auto auto;
      width:180px;height:180px;opacity:.22;transform:rotate(12deg);
      background: radial-gradient(circle at 30% 30%, var(--gold), transparent 60%),
                  radial-gradient(circle at 60% 70%, var(--gold2), transparent 55%);
      border-radius: 40% 60% 70% 30% / 50% 40% 60% 50%;
      pointer-events:none;
    }
    .leaf.left{
      inset:auto auto -25px -25px;
      transform:rotate(-18deg);
      width:230px;height:230px;
      opacity:.18;
    }
    .small{font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;}
    .badge{
      display:inline-block;
      padding:7px 12px;
      border:1px solid var(--ring);
      border-radius:999px;
      letter-spacing:.08em;
      font-size:12px;
      color:var(--gold2);
      background: rgba(255,255,255,.55);
      backdrop-filter: blur(6px);
      text-transform:uppercase;
    }
    .title{
      margin:14px 0 6px;
      font-size:38px;
      line-height:1.05;
      color:var(--gold2);
      font-style: italic;
      letter-spacing:.02em;
    }
    .subtitle{margin:0 0 10px;font-size:15px;color:var(--muted)}
    .date{margin:10px 0 0;font-weight:800;letter-spacing:.03em;font-size:18px}
    .btn{
      display:inline-flex;align-items:center;justify-content:center;gap:10px;
      padding:12px 16px;border-radius:14px;
      border:1px solid rgba(183,154,106,.45);
      background: linear-gradient(180deg, rgba(183,154,106,.22), rgba(183,154,106,.08));
      color: #3b2f1f;text-decoration:none;font-weight:800;
      box-shadow: 0 8px 18px rgba(183,154,106,.20);
      cursor:pointer;user-select:none;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
    .btn:active{transform: translateY(1px)}
    .btn svg{width:18px;height:18px}
    .btn.ghost{
      background: rgba(255,255,255,.55);
      box-shadow:none;
    }
    .section{padding:18px 18px 2px}
    .section h3{
      margin:0 0 10px;
      font-size:18px;
      color:var(--gold2);
      letter-spacing:.02em;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
    .p{margin:0 0 12px;line-height:1.75;color:#3a3a3a;font-size:15px}
    .divider{height:1px;background:rgba(183,154,106,.18);margin:6px 18px}
    .names{display:grid;gap:12px;margin:10px 0 6px}
    .box{
      border:1px solid rgba(183,154,106,.25);
      border-radius:18px;
      padding:14px 14px;
      background:rgba(255,255,255,.56);
    }
    .name{font-size:22px;color:var(--gold2);margin:0 0 4px;font-style: italic}
    .meta{margin:0;color:var(--muted);font-size:13px;line-height:1.65;font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .count{
      text-align:center;padding:10px 10px;
      border-radius:16px;border:1px solid rgba(183,154,106,.22);
      background:rgba(255,255,255,.55);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
    .count b{display:block;font-size:22px;color:#2a2a2a}
    .count span{font-size:12px;color:var(--muted);letter-spacing:.08em;text-transform:uppercase}
    .eventgrid{display:grid;gap:12px;margin:6px 0 14px}
    .tt{font-weight:900;color:var(--gold2);margin:0 0 8px;letter-spacing:.02em}
    .row{display:flex;gap:10px;align-items:flex-start;margin:6px 0}
    .ic{
      width:26px;height:26px;border-radius:10px;display:grid;place-items:center;
      border:1px solid rgba(183,154,106,.28);
      background: rgba(183,154,106,.10);
      flex:0 0 auto;
    }
    .ic svg{width:16px;height:16px}
    .quote{
      margin:0 0 14px;padding:14px;
      border-left:4px solid rgba(183,154,106,.55);
      background: rgba(183,154,106,.08);
      border-radius:14px;line-height:1.75;
      color:#3b2f1f;font-size:14px;
    }
    .actions{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;padding:6px 18px 18px}
    .gallery{
      display:grid;
      grid-template-columns:repeat(2,1fr);
      gap:10px;
      margin:10px 0 14px;
    }
    .ph{
      aspect-ratio: 1 / 1;
      border-radius:18px;
      border:1px solid rgba(183,154,106,.25);
      overflow:hidden;
      background:
        radial-gradient(120px 120px at 30% 30%, rgba(183,154,106,.25), transparent 60%),
        radial-gradient(120px 120px at 70% 70%, rgba(138,110,69,.18), transparent 55%),
        linear-gradient(180deg, rgba(255,255,255,.8), rgba(255,255,255,.45));
      position:relative;
    }
    .ph::after{
      content:"Ganti foto";
      position:absolute;inset:auto 10px 10px 10px;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      font-size:12px;color:var(--muted);
      background:rgba(255,255,255,.6);
      border:1px solid rgba(183,154,106,.22);
      border-radius:12px;
      padding:6px 10px;
      text-align:center;
      backdrop-filter: blur(6px);
    }
    .field{display:grid;gap:8px;margin:10px 0}
    label{font-size:12px;color:var(--muted);letter-spacing:.08em;text-transform:uppercase;font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;}
    input, select, textarea{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid rgba(183,154,106,.30);
      background: rgba(255,255,255,.75);
      font-size:15px;
      outline:none;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
    textarea{min-height:92px;resize:vertical}
    .list{
      margin:10px 0 18px;
      display:grid;gap:10px;
    }
    .msg{
      border-radius:18px;
      border:1px solid rgba(183,154,106,.22);
      background:rgba(255,255,255,.55);
      padding:12px 12px;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
    .msg b{display:block;margin-bottom:4px}
    .msg small{color:var(--muted)}
    .footer{
      padding:0 18px 22px;text-align:center;
      color:var(--muted);font-size:12px;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    /* Modal: nama tamu + tombol musik */
    .modal{
      position:fixed;inset:0;background: rgba(0,0,0,.55);
      display:none;align-items:flex-end;justify-content:center;
      padding:14px;z-index:60;
    }
    .modal.open{display:flex}
    .sheet{
      width:min(560px, 100%);
      background: var(--paper);
      border:1px solid rgba(183,154,106,.25);
      border-radius: 22px;
      box-shadow: var(--shadow);
      overflow:hidden;
      animation: pop .2s ease-out;
    }
    @keyframes pop{from{transform:translateY(10px);opacity:.8}to{transform:translateY(0);opacity:1}}
    .sheethead{
      padding:14px 16px;display:flex;align-items:center;justify-content:space-between;gap:10px;
      border-bottom:1px solid rgba(183,154,106,.2);
      background: rgba(183,154,106,.08);
    }
    .sheethead b{color:var(--gold2);font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;}
    .x{
      width:36px;height:36px;border-radius:12px;border:1px solid rgba(183,154,106,.3);
      background: rgba(255,255,255,.6);cursor:pointer;display:grid;place-items:center;
    }
    .sheetbody{padding:14px 16px 18px}
    .help{margin:10px 0 0;color:var(--muted);font-size:12px;line-height:1.5;font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;}
    .sticky{
      position:fixed;left:0;right:0;bottom:0;
      display:flex;justify-content:center;gap:10px;
      padding:10px 14px;
      background: linear-gradient(180deg, transparent, rgba(0,0,0,.08));
      backdrop-filter: blur(6px);
      z-index:50;
    }
    .sticky .btn{width:min(560px, 100%)}
    .mini{
      position:fixed;right:14px;bottom:78px;z-index:55;
      display:flex;flex-direction:column;gap:10px;
    }
    .fab{
      width:48px;height:48px;border-radius:16px;
      border:1px solid rgba(183,154,106,.35);
      background: rgba(255,255,255,.65);
      box-shadow: 0 10px 24px rgba(0,0,0,.12);
      display:grid;place-items:center;
      cursor:pointer;
    }
    .fab svg{width:20px;height:20px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" id="top">
      <div class="hero">
        <div class="leaf"></div>
        <span class="badge small" id="badge">THE WEDDING OF</span>
        <div class="title">Nasrul &amp; Naya</div>
        <div class="subtitle small">Dengan memohon rahmat dan ridho Allah SWT</div>
        <div class="date small">Ahad, 7 Februari 2026</div>

        <div style="height:14px"></div>
        <button class="btn" id="openBtn" type="button">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 4h16v16H4z"/><path d="M4 8h16"/><path d="M8 12h8"/><path d="M8 16h6"/>
          </svg>
          Buka Undangan
        </button>

        <div class="leaf left"></div>
      </div>

      <div class="section">
        <h3>Save the Date</h3>
        <p class="p">
          Kami mengundang Bapak/Ibu/Saudara/i untuk hadir dan memberikan doa restu pada acara pernikahan kami.
        </p>
        <div class="grid2">
          <div class="count"><b id="d">0</b><span>Hari</span></div>
          <div class="count"><b id="h">0</b><span>Jam</span></div>
          <div class="count"><b id="m">0</b><span>Menit</span></div>
          <div class="count"><b id="s">0</b><span>Detik</span></div>
        </div>
      </div>

      <div class="divider"></div>

      <div class="section">
        <h3>Assalamu‚Äôalaikum Warahmatullahi Wabarakatuh</h3>
        <p class="p">
          Dengan memohon rahmat dan ridho Allah SWT, kami bermaksud menyelenggarakan
          acara akad nikah dan resepsi pernikahan:
        </p>

        <div class="names">
          <div class="box">
            <p class="name">Nasrul</p>
            <p class="meta">Putra dari Ibu <b>Nur Halimah</b></p>
          </div>
          <div class="box">
            <p class="name">Naya</p>
            <p class="meta">Putri dari Ibu <b>Nur Halimah</b></p>
          </div>
        </div>
      </div>

      <div class="divider"></div>

      <div class="section" id="acara">
        <h3>Detail Acara</h3>
        <div class="eventgrid">
          <div class="box">
            <p class="tt small">Akad Nikah</p>
            <div class="row">
              <div class="ic">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="9"/><path d="M12 7v6l4 2"/>
                </svg>
              </div>
              <div class="meta">
                <b>Ahad, 7 Februari 2026</b><br/>
                Pukul <b>09.00 WIB</b>
              </div>
            </div>
            <div class="row">
              <div class="ic">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M12 21s7-4.5 7-11a7 7 0 0 0-14 0c0 6.5 7 11 7 11z"/>
                  <circle cx="12" cy="10" r="2"/>
                </svg>
              </div>
              <div class="meta">
                Lokasi: <b>Rusun</b>
              </div>
            </div>
          </div>

          <div class="box">
            <p class="tt small">Resepsi</p>
            <div class="row">
              <div class="ic">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="9"/><path d="M12 7v6l4 2"/>
                </svg>
              </div>
              <div class="meta">
                <b>Ahad, 7 Februari 2026</b><br/>
                Pukul <b>11.00 WIB</b> ‚Äì selesai
              </div>
            </div>
            <div class="row">
              <div class="ic">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M12 21s7-4.5 7-11a7 7 0 0 0-14 0c0 6.5 7 11 7 11z"/>
                  <circle cx="12" cy="10" r="2"/>
                </svg>
              </div>
              <div class="meta">
                Lokasi: <b>Rusun</b>
              </div>
            </div>
          </div>
        </div>

        <div class="actions">
          <a class="btn" id="mapsBtn" href="https://maps.app.goo.gl/ffLGd3GRFQGsXqba8" target="_blank" rel="noopener">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 21s7-4.5 7-11a7 7 0 0 0-14 0c0 6.5 7 11 7 11z"/>
              <circle cx="12" cy="10" r="2"/>
            </svg>
            Buka Maps
          </a>
          <a class="btn" id="waBtn" href="#" target="_blank" rel="noopener">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 12a8.5 8.5 0 0 1-12.7 7.3L3 21l1.8-5.2A8.5 8.5 0 1 1 21 12z"/>
              <path d="M8.5 10.5c1.6 3.2 3.8 5.4 7 7"/>
            </svg>
            Bagikan WhatsApp
          </a>
          <a class="btn ghost" id="copyBtn" href="#" role="button">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 9h10v10H9z"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
            </svg>
            Copy Link
          </a>
        </div>
      </div>

      <div class="divider"></div>

      <div class="section" id="galeri">
        <h3>Wedding Gallery</h3>
        <p class="p">Ganti foto-foto di bagian galeri dengan foto kalian (lihat catatan di bawah).</p>
        <div class="gallery" id="gallery">
          <div class="ph"></div>
          <div class="ph"></div>
          <div class="ph"></div>
          <div class="ph"></div>
          <div class="ph"></div>
          <div class="ph"></div>
        </div>
        <p class="p small" style="color:var(--muted);font-size:13px">
          Catatan: kalau mau fotonya beneran tampil, ganti array <b>GALLERY_URLS</b> di script (paling bawah).
        </p>
      </div>

      <div class="divider"></div>

      <div class="section">
        <h3>Doa Pernikahan</h3>
        <div class="quote">
          ‚ÄúDan di antara tanda-tanda (kebesaran)-Nya ialah Dia menciptakan pasangan-pasangan untukmu dari jenismu sendiri,
          agar kamu cenderung dan merasa tenteram kepadanya, dan Dia menjadikan di antaramu rasa kasih dan sayang.‚Äù
          <br><b>(QS. Ar-Rum : 21)</b>
        </div>
        <p class="p">
          Merupakan suatu kehormatan dan kebahagiaan bagi kami apabila Bapak/Ibu/Saudara/i berkenan hadir serta memberikan doa restu.
        </p>
        <p class="p"><b>Wassalamu‚Äôalaikum Warahmatullahi Wabarakatuh</b></p>
      </div>

      <div class="divider"></div>

      <div class="section" id="rsvp">
        <h3>RSVP & Ucapan</h3>
        <p class="p">Isi konfirmasi kehadiran dan tulis ucapan ya ü§ç (tersimpan di perangkat pengunjung).</p>

        <form id="rsvpForm" class="box">
          <div class="field">
            <label>Nama</label>
            <input id="fNama" placeholder="Nama kamu" required />
          </div>

          <div class="field">
            <label>Kehadiran</label>
            <select id="fHadir" required>
              <option value="">Pilih</option>
              <option value="Hadir">Hadir</option>
              <option value="Tidak hadir">Tidak hadir</option>
              <option value="Masih ragu">Masih ragu</option>
            </select>
          </div>

          <div class="field">
            <label>Ucapan</label>
            <textarea id="fUcapan" placeholder="Tulis ucapan untuk Nasrul & Naya..." required></textarea>
          </div>

          <button class="btn" type="submit" style="width:100%">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 2 11 13"/><path d="M22 2 15 22l-4-9-9-4 20-7z"/>
            </svg>
            Kirim
          </button>

          <p class="help">Kalau mau versi yang beneran nyimpen ke server (bisa dilihat semua orang), bilang‚Äîaku bikinin versi Firebase/Sheet.</p>
        </form>

        <div class="list" id="msgList"></div>

        <button class="btn ghost" id="clearLocal" type="button" style="width:100%">
          Hapus data RSVP (di perangkat ini)
        </button>
      </div>

      <div class="footer">
        ¬© 2026 ‚Ä¢ Nasrul & Naya
      </div>
    </div>
  </div>

  <!-- tombol kecil kanan bawah: musik -->
  <div class="mini">
    <button class="fab" id="musicBtn" title="Musik">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M9 18V5l12-2v13"/><circle cx="7" cy="18" r="2"/><circle cx="19" cy="16" r="2"/>
      </svg>
    </button>
    <a class="fab" href="#top" title="Ke atas">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 19V5"/><path d="m5 12 7-7 7 7"/>
      </svg>
    </a>
  </div>

  <div class="sticky">
    <button class="btn" id="openBtn2" type="button">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M4 4h16v16H4z"/><path d="M4 8h16"/><path d="M8 12h8"/><path d="M8 16h6"/>
      </svg>
      Buka Undangan
    </button>
  </div>

  <!-- modal: isi nama tamu + start musik -->
  <div class="modal" id="modal" aria-hidden="true">
    <div class="sheet" role="dialog" aria-modal="true">
      <div class="sheethead">
        <b>Undangan untuk:</b>
        <button class="x" id="closeBtn" aria-label="Tutup">‚úï</button>
      </div>
      <div class="sheetbody">
        <p class="small" style="margin:0 0 10px;color:var(--muted)">
          Isi nama tamu biar personal. Setelah masuk, musik bisa diputar.
        </p>

        <input class="input" id="guestInput" placeholder="Contoh: Bapak/Ibu Rudi" />

        <div style="height:12px"></div>

        <button class="btn" id="enterBtn" type="button" style="width:100%">
          Masuk & Putar Musik
        </button>

        <p class="help">
          Tip link: tambah <b>?to=Nama%20Tamu</b> di URL. <br/>
          Contoh: <b>.../index.html?to=Bapak%20Rudi</b>
        </p>
      </div>
    </div>
  </div>

  <!-- Musik (ganti URL musiknya) -->
  <audio id="bgm" preload="auto" loop>
    <!-- GANTI ke link mp3 kamu -->
    <source src="YOUR_MUSIC_URL.mp3" type="audio/mpeg">
  </audio>

  <script>
    // ===== CONFIG =====
    const CONFIG = {
      couple: "Nasrul & Naya",
      dateLabel: "Ahad, 7 Februari 2026",
      // Countdown target: Akad 09:00 WIB
      targetISO: "2026-02-07T09:00:00+07:00",
      locationText: "Rusun",
      mapsLink: "https://maps.app.goo.gl/ffLGd3GRFQGsXqba8",
      waText:
`Assalamu‚Äôalaikum Warahmatullahi Wabarakatuh

Dengan memohon rahmat dan ridho Allah SWT, kami mengundang Bapak/Ibu/Saudara/i untuk menghadiri pernikahan:

Nasrul & Naya
Ahad, 7 Februari 2026
Akad: 09.00 WIB
Resepsi: 11.00 WIB ‚Äì selesai
Lokasi: Rusun

Mohon doa restunya. Terima kasih.`
    };

    // GANTI foto-foto kalian di sini (pakai URL foto)
    const GALLERY_URLS = [
      // "https://.../foto1.jpg",
      // "https://.../foto2.jpg",
      // "https://.../foto3.jpg",
      // "https://.../foto4.jpg",
      // "https://.../foto5.jpg",
      // "https://.../foto6.jpg",
    ];

    // ===== Helpers =====
    const qs = (k) => new URLSearchParams(location.search).get(k);
    const enc = encodeURIComponent;

    function setGuestName(name){
      const badge = document.getElementById("badge");
      if(name && name.trim()){
        badge.textContent = `KEPADA YTH: ${name.trim().toUpperCase()}`;
      }else{
        badge.textContent = "THE WEDDING OF";
      }
    }

    function updateCountdown(){
      const target = new Date(CONFIG.targetISO).getTime();
      const now = Date.now();
      let diff = Math.max(0, target - now);

      const d = Math.floor(diff / (1000*60*60*24)); diff -= d*(1000*60*60*24);
      const h = Math.floor(diff / (1000*60*60)); diff -= h*(1000*60*60);
      const m = Math.floor(diff / (1000*60)); diff -= m*(1000*60);
      const s = Math.floor(diff / 1000);

      document.getElementById("d").textContent = d;
      document.getElementById("h").textContent = h;
      document.getElementById("m").textContent = m;
      document.getElementById("s").textContent = s;
    }

    function renderGallery(){
      if(!GALLERY_URLS.length) return;
      const g = document.getElementById("gallery");
      g.innerHTML = "";
      GALLERY_URLS.slice(0, 12).forEach((url) => {
        const el = document.createElement("div");
        el.className = "ph";
        el.style.backgroundImage = `url('${url}')`;
        el.style.backgroundSize = "cover";
        el.style.backgroundPosition = "center";
        el.style.backgroundRepeat = "no-repeat";
        el.innerHTML = "";
        g.appendChild(el);
      });
    }

    // ===== Maps, WA, Copy Link =====
    const waBtn = document.getElementById("waBtn");
    waBtn.href = "https://wa.me/?text=" + enc(CONFIG.waText + "\n\nLink: " + location.href);

    document.getElementById("copyBtn").addEventListener("click", async (e)=>{
      e.preventDefault();
      try{
        await navigator.clipboard.writeText(location.href);
        alert("Link berhasil dicopy!");
      }catch{
        prompt("Copy manual:", location.href);
      }
    });

    // ===== Modal / Personalization =====
    const modal = document.getElementById("modal");
    const open = () => { modal.classList.add("open"); modal.setAttribute("aria-hidden","false"); setTimeout(()=>document.getElementById("guestInput").focus(), 50); };
    const close = () => { modal.classList.remove("open"); modal.setAttribute("aria-hidden","true"); };

    document.getElementById("openBtn").addEventListener("click", open);
    document.getElementById("openBtn2").addEventListener("click", open);
    document.getElementById("closeBtn").addEventListener("click", close);
    modal.addEventListener("click", (e)=>{ if(e.target === modal) close(); });

    // ===== Music =====
    const audio = document.getElementById("bgm");
    let isPlaying = false;

    async function toggleMusic(){
      try{
        if(!isPlaying){
          await audio.play();
          isPlaying = true;
        }else{
          audio.pause();
          isPlaying = false;
        }
      }catch(err){
        alert("Musik belum bisa diputar. Pastikan kamu sudah ganti YOUR_MUSIC_URL.mp3 dengan link mp3 yang valid.");
      }
    }

    document.getElementById("musicBtn").addEventListener("click", toggleMusic);

    document.getElementById("enterBtn").addEventListener("click", async ()=>{
      const val = document.getElementById("guestInput").value;
      const url = new URL(location.href);
      if(val && val.trim()) url.searchParams.set("to", val.trim());
      history.replaceState({}, "", url.toString());
      setGuestName(val);
      close();
      document.getElementById("top").scrollIntoView({behavior:"smooth"});
      // try start music on user gesture
      await toggleMusic();
    });

    // ===== RSVP + Ucapan (LocalStorage) =====
    const KEY = "rsvp_nasrul_naya_msgs_v1";

    function loadMsgs(){
      try{ return JSON.parse(localStorage.getItem(KEY) || "[]"); }
      catch{ return []; }
    }
    function saveMsgs(arr){
      localStorage.setItem(KEY, JSON.stringify(arr));
    }
    function renderMsgs(){
      const list = document.getElementById("msgList");
      const msgs = loadMsgs().slice().reverse();
      if(!msgs.length){
        list.innerHTML = `<div class="msg"><b>Belum ada ucapan</b><small>Jadi yang pertama ya üòÑ</small></div>`;
        return;
      }
      list.innerHTML = msgs.map(m => `
        <div class="msg">
          <b>${escapeHtml(m.nama)} ‚Ä¢ <small>${escapeHtml(m.hadir)}</small></b>
          <div>${escapeHtml(m.ucapan)}</div>
          <small>${new Date(m.ts).toLocaleString("id-ID")}</small>
        </div>
      `).join("");
    }

    function escapeHtml(s){
      return String(s)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    document.getElementById("rsvpForm").addEventListener("submit", (e)=>{
      e.preventDefault();
      const nama = document.getElementById("fNama").value.trim();
      const hadir = document.getElementById("fHadir").value;
      const ucapan = document.getElementById("fUcapan").value.trim();
      if(!nama || !hadir || !ucapan) return;

      const msgs = loadMsgs();
      msgs.push({nama, hadir, ucapan, ts: Date.now()});
      saveMsgs(msgs);

      e.target.reset();
      renderMsgs();
      alert("Terkirim! Makasih ya ü§ç");
    });

    document.getElementById("clearLocal").addEventListener("click", ()=>{
      if(confirm("Hapus semua data RSVP/ucapan di perangkat ini?")){
        localStorage.removeItem(KEY);
        renderMsgs();
      }
    });

    // ===== Init =====
    setGuestName(qs("to"));
    updateCountdown();
    setInterval(updateCountdown, 1000);
    renderGallery();
    renderMsgs();
  </script>
</body>
</html>
